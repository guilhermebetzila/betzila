generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id        Int       @id @default(autoincrement())
  email     String    @unique
  nome      String
  senha     String
  saldo     Float     @default(0)
  indicador String?
  cartelas  Cartela[]
}

model Partida {
  id          Int       @id @default(autoincrement())
  inicio      DateTime  @default(now())
  fim         DateTime?
  finalizada  Boolean   @default(false)
  aberta      Boolean   @default(true)
  encerrada   Boolean   @default(false)

  vencedoraId Int?      @unique
  vencedora   Cartela?  @relation("VencedoraDaPartida", fields: [vencedoraId], references: [id])

  cartelas    Cartela[]
  bolas       Bola[]
}

model Cartela {
  id               Int             @id @default(autoincrement())
  criadaEm         DateTime        @default(now())
  venceu           Boolean         @default(false)
  userId           Int?            // <- Agora pode ser nulo
  user             User?           @relation(fields: [userId], references: [id])
  partidaId        Int
  partida          Partida         @relation(fields: [partidaId], references: [id])
  numeros          NumeroCartela[]

  partidasVencidas Partida[]       @relation("VencedoraDaPartida")
}

model NumeroCartela {
  id        Int     @id @default(autoincrement())
  numero    Int
  cartelaId Int
  cartela   Cartela @relation(fields: [cartelaId], references: [id])
}

model Bola {
  id        Int     @id @default(autoincrement())
  numero    Int
  ordem     Int
  partidaId Int
  partida   Partida @relation(fields: [partidaId], references: [id])
}
